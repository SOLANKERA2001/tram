{"signal": "title: Defending Users’ NAS Devices From Evolving Threats\nurl: https://www.trendmicro.com/en_us/research/22/a/defending-users-NAS-devices-from-evolving-threats.html\n\nDefending Users’ NAS Devices From Evolving Threats\nIn our latest research, we analyze the threats targeting well-known brands of network-attached storage (NAS) devices. \nBy: Stephen Hilt, Fernando Merces\n\t\t\n\t\t\tJanuary 20, 2022Read time:  ( words)\n\t\n\n\n\n\n\n\n\n\n\n\nSave to Folio\n\n\n\n\n\n Subscribe\n\n\n\n\n\n\n\n\n\n\nThreats to the internet of things (IoT) continue to evolve as users and businesses grow increasingly reliant on these tools for constant connectivity, access to information and data, and workflow continuity. Cybercriminals have taken notice of this dependence and now regularly update their known tools and routines to include network-attached storage (NAS) devices to their list of targets, knowing full well that users rely on these devices for storing and backing up files in both modern homes and businesses. More importantly, cybercriminals are aware that these tools hold valuable information and have only minimal security measures.\nIn our latest research paper, “Backing Your Backup: Defending NAS Devices Against Evolving Threats,” we studied the current infrastructure, environment, threats, and recommendations for defending systems against current threats targeting NAS devices. To emphasize the importance of mitigating the risks of malware infection and targeted attacks on NAS devices, we analyzed the technical details of two malware families that potentially included NAS devices in their existing business models, the REvil ransomware and StealthWorker botnets.\nREvil\nWhile the disappearance of REvil (aka Sodinokibi) in mid-2021 is filled with uncertainty, security researchers have found a Linux version of the REvil ransomware that they have dubbed as Revix. After analyzing the samples, we found four different versions of the malware, all of which rely on an embedded JavaScript Observed Notation (JSON)-based configuration to set parameters before encrypting files. \n\n\n\nFigure 1. Revix’s JSON-based configuration\n\n\n\nWhile some parameters are ignored by the ransomware, these are most important ones that we observed:\npk: A 64-byte key\nnbody: The ransomware note text-encoded in base64\nnname: The ransomware note name\next: The extension added to encrypted files\nAfter compromising the system, the malicious actors execute it manually on a NAS device to encrypt files and create a ransom note with a unique key per victim.\n\n\n\nFigure 2. Revix encrypting a QNAP NAS device\n\nFigure 3. Revix ransom note \n\n\nWhile the differences between the versions are minor, the group advertised the capability of encrypting NAS devices as early as May 2021 in underground forums. Given the vulnerability of NAS devices that are directly connected to the internet, we can expect a new wave of ransomware attacks affecting these gadgets in the future.\nStealthWorker\nIn 2021, security researchers found brute-force attacks launched from the StealthWorker botnet on Synology NAS devices. We found multiple samples for this botnet and confirmed that newer versions are capable of brute-forcing and compromising servers running on several products and systems such as WooCommerce and WordPress. This botnet is also designed to generally attack any web server using HTTP authentication and other NAS devices like QNAP. Valid credentials found during compromise are then uploaded to the command-and-control (C&C) server, usually at port 5028/TCP.\n\n\n\nFigure 4. StealthWorker brute-force function targeting QNAP devices\n\nFigure 5. Infected Linux device connected to a C&C server\n\n\nHow to protect NAS devices\nWithout proper security implemented in NAS devices, users and businesses will continue to be targeted since these tools can be used as entry points for information theft, malware infection, and the disruption of operations, among others. Here are some best practices to protect your systems against threats that leverage the gaps in your NAS devices:\nAvoid connecting a NAS device directly to the internet.\nRegularly change the credentials for accessing an NAS device. Never use the preset default credentials that come with the device as these are well-known to malicious actors.\nEnable two-factor authentication (2FA) for additional security.\nRegularly check NAS manufacturers’ online security guides, such as Synology’s recommended best practices and QNAP’s recently released suggestions on how to help defend their devices against additional exposure on the internet.\nTo find more technical details, threats, insights, and recommendations in protecting your NAS device, download our research “Backing Your Backup: Defending NAS Devices Against Evolving Threats.”\n\n\n\n\n\t\n\t\tAuthors\n\t\n\n\n\nStephen Hilt\nSr. Threat Researcher\n\n\n\n\nFernando Merces\nSr. Threat Researcher\n", "metadata": {"phasesDone": ["zone", "token", "content"]}, "asets": [{"type": "zone", "hasID": false, "hasSpan": true, "attrs": [{"name": "region_type", "type": "string", "aggregation": null}], "annots": [[0, 4833, "body"]]}, {"type": "lex", "hasID": false, "hasSpan": true, "attrs": [], "annots": [[0, 5], [5, 6], [7, 16], [17, 23], [24, 27], [28, 35], [36, 40], [41, 49], [50, 57], [58, 61], [61, 62], [63, 68], [68, 71], [71, 74], [74, 75], [75, 85], [85, 86], [86, 89], [89, 90], [90, 95], [95, 96], [96, 104], [104, 105], [105, 107], [107, 108], [108, 109], [109, 110], [110, 159], [159, 160], [160, 164], [166, 175], [176, 182], [183, 186], [187, 194], [195, 199], [200, 208], [209, 216], [217, 219], [220, 223], [224, 230], [231, 239], [239, 240], [241, 243], [244, 251], [252, 255], [256, 263], [264, 273], [274, 284], [285, 291], [292, 294], [295, 311], [312, 319], [320, 321], [321, 324], [324, 325], [326, 333], [333, 334], [336, 338], [338, 339], [340, 347], [348, 352], [352, 353], [354, 362], [363, 369], [376, 383], [384, 386], [386, 387], [388, 396], [397, 401], [401, 402], [404, 405], [406, 411], [411, 412], [425, 429], [430, 432], [433, 438], [445, 454], [465, 472], [473, 475], [476, 479], [480, 488], [489, 491], [492, 498], [499, 500], [500, 503], [503, 504], [505, 513], [514, 516], [517, 523], [524, 526], [527, 532], [533, 536], [537, 547], [548, 552], [553, 565], [566, 573], [574, 576], [577, 582], [583, 588], [589, 592], [593, 601], [602, 614], [614, 615], [616, 622], [623, 625], [626, 637], [638, 641], [642, 646], [646, 647], [648, 651], [652, 660], [661, 671], [671, 672], [673, 687], [688, 692], [693, 698], [699, 705], [706, 708], [709, 713], [714, 724], [725, 728], [729, 732], [733, 742], [743, 749], [750, 755], [756, 761], [762, 767], [768, 771], [772, 780], [781, 783], [784, 791], [792, 808], [809, 816], [817, 818], [818, 821], [821, 822], [823, 830], [831, 833], [834, 839], [840, 844], [845, 847], [848, 855], [855, 856], [857, 864], [865, 869], [870, 874], [875, 879], [880, 885], [886, 890], [891, 893], [894, 899], [900, 907], [908, 911], [912, 919], [920, 923], [924, 931], [932, 934], [935, 940], [941, 943], [944, 948], [949, 955], [956, 961], [962, 965], [966, 976], [976, 977], [978, 982], [983, 994], [994, 995], [996, 1010], [1011, 1014], [1015, 1020], [1021, 1025], [1026, 1031], [1032, 1037], [1038, 1042], [1043, 1051], [1052, 1063], [1064, 1067], [1068, 1072], [1073, 1077], [1078, 1085], [1086, 1094], [1095, 1103], [1103, 1104], [1105, 1107], [1108, 1111], [1112, 1118], [1119, 1127], [1128, 1133], [1133, 1134], [1135, 1143], [1144, 1148], [1149, 1155], [1155, 1156], [1157, 1166], [1167, 1170], [1171, 1178], [1179, 1186], [1187, 1195], [1196, 1203], [1203, 1204], [1204, 1205], [1206, 1208], [1209, 1216], [1217, 1220], [1221, 1228], [1229, 1243], [1243, 1244], [1245, 1256], [1256, 1257], [1258, 1265], [1265, 1266], [1267, 1270], [1271, 1286], [1287, 1290], [1291, 1300], [1301, 1308], [1309, 1316], [1317, 1324], [1325, 1332], [1333, 1342], [1343, 1346], [1347, 1354], [1354, 1355], [1356, 1358], [1359, 1368], [1369, 1372], [1373, 1383], [1384, 1386], [1387, 1397], [1398, 1401], [1402, 1407], [1408, 1410], [1411, 1418], [1419, 1428], [1429, 1432], [1433, 1441], [1442, 1449], [1450, 1452], [1453, 1456], [1457, 1464], [1464, 1465], [1466, 1468], [1469, 1477], [1478, 1481], [1482, 1491], [1492, 1499], [1500, 1502], [1503, 1506], [1507, 1514], [1515, 1523], [1524, 1528], [1529, 1540], [1541, 1549], [1550, 1553], [1554, 1561], [1562, 1564], [1565, 1570], [1571, 1579], [1580, 1588], [1589, 1595], [1595, 1596], [1597, 1600], [1601, 1606], [1607, 1617], [1618, 1621], [1622, 1635], [1636, 1643], [1643, 1644], [1645, 1650], [1651, 1656], [1657, 1660], [1661, 1674], [1675, 1677], [1678, 1683], [1684, 1685], [1685, 1688], [1689, 1699], [1699, 1700], [1701, 1703], [1704, 1708], [1708, 1712], [1713, 1715], [1716, 1722], [1723, 1727], [1728, 1739], [1739, 1740], [1741, 1749], [1750, 1761], [1762, 1766], [1767, 1772], [1773, 1774], [1775, 1780], [1781, 1788], [1789, 1791], [1792, 1795], [1796, 1801], [1802, 1812], [1813, 1817], [1818, 1822], [1823, 1827], [1828, 1834], [1835, 1837], [1838, 1843], [1843, 1844], [1845, 1850], [1851, 1860], [1861, 1864], [1865, 1872], [1872, 1873], [1874, 1876], [1877, 1882], [1883, 1887], [1888, 1897], [1898, 1906], [1907, 1909], [1910, 1913], [1914, 1921], [1921, 1922], [1923, 1926], [1927, 1929], [1930, 1935], [1936, 1940], [1941, 1943], [1944, 1946], [1947, 1955], [1956, 1966], [1967, 1975], [1976, 1984], [1985, 1986], [1986, 1990], [1990, 1992], [1992, 1997], [1998, 2011], [2012, 2014], [2015, 2018], [2019, 2029], [2030, 2036], [2037, 2047], [2048, 2053], [2053, 2054], [2059, 2065], [2066, 2067], [2067, 2068], [2069, 2076], [2077, 2087], [2088, 2101], [2105, 2110], [2111, 2115], [2116, 2126], [2127, 2130], [2131, 2138], [2139, 2141], [2142, 2145], [2146, 2156], [2156, 2157], [2158, 2163], [2164, 2167], [2168, 2172], [2173, 2182], [2183, 2187], [2188, 2192], [2193, 2195], [2196, 2204], [2204, 2205], [2206, 2208], [2208, 2209], [2210, 2211], [2212, 2214], [2214, 2219], [2220, 2223], [2224, 2229], [2229, 2230], [2231, 2234], [2235, 2245], [2246, 2250], [2251, 2263], [2264, 2266], [2267, 2273], [2274, 2279], [2279, 2280], [2281, 2284], [2285, 2295], [2296, 2300], [2301, 2305], [2306, 2309], [2309, 2310], [2311, 2314], [2315, 2324], [2325, 2330], [2331, 2333], [2334, 2343], [2344, 2349], [2350, 2355], [2356, 2368], [2369, 2372], [2373, 2379], [2379, 2380], [2381, 2384], [2385, 2394], [2395, 2401], [2402, 2409], [2410, 2412], [2413, 2421], [2422, 2424], [2425, 2426], [2427, 2430], [2431, 2437], [2438, 2440], [2441, 2448], [2449, 2454], [2455, 2458], [2459, 2465], [2466, 2467], [2468, 2474], [2475, 2479], [2480, 2484], [2485, 2486], [2487, 2493], [2494, 2497], [2498, 2501], [2502, 2508], [2508, 2509], [2513, 2519], [2520, 2521], [2521, 2522], [2523, 2528], [2529, 2539], [2540, 2541], [2542, 2546], [2547, 2550], [2551, 2557], [2559, 2565], [2566, 2567], [2567, 2568], [2569, 2574], [2575, 2581], [2582, 2586], [2590, 2595], [2596, 2599], [2600, 2611], [2612, 2619], [2620, 2623], [2624, 2632], [2633, 2636], [2637, 2642], [2642, 2643], [2644, 2647], [2648, 2653], [2654, 2664], [2665, 2668], [2669, 2679], [2680, 2682], [2683, 2693], [2694, 2697], [2698, 2705], [2706, 2708], [2709, 2714], [2715, 2717], [2718, 2721], [2722, 2726], [2727, 2729], [2730, 2741], [2742, 2748], [2748, 2749], [2750, 2755], [2756, 2759], [2760, 2773], [2774, 2776], [2777, 2780], [2781, 2788], [2789, 2793], [2794, 2797], [2798, 2806], [2807, 2816], [2817, 2819], [2820, 2823], [2824, 2832], [2832, 2833], [2834, 2836], [2837, 2840], [2841, 2847], [2848, 2849], [2850, 2853], [2854, 2858], [2859, 2861], [2862, 2872], [2873, 2880], [2881, 2890], [2891, 2896], [2897, 2904], [2905, 2907], [2908, 2911], [2912, 2918], [2918, 2919], [2920, 2933], [2934, 2936], [2937, 2941], [2941, 2942], [2943, 2951], [2952, 2963], [2964, 2969], [2970, 2981], [2982, 2989], [2990, 2998], [2999, 3003], [3004, 3007], [3008, 3021], [3022, 3028], [3029, 3031], [3032, 3040], [3041, 3044], [3045, 3052], [3052, 3053], [3054, 3056], [3057, 3062], [3063, 3071], [3072, 3079], [3080, 3083], [3084, 3088], [3089, 3095], [3096, 3099], [3100, 3109], [3110, 3114], [3115, 3120], [3121, 3129], [3130, 3133], [3134, 3141], [3142, 3144], [3145, 3158], [3159, 3162], [3163, 3175], [3176, 3183], [3184, 3191], [3192, 3194], [3195, 3202], [3203, 3211], [3212, 3215], [3216, 3223], [3224, 3228], [3229, 3231], [3232, 3243], [3244, 3247], [3248, 3257], [3257, 3258], [3259, 3263], [3264, 3270], [3271, 3273], [3274, 3278], [3279, 3287], [3288, 3290], [3291, 3300], [3301, 3307], [3308, 3311], [3312, 3315], [3316, 3322], [3323, 3328], [3329, 3333], [3334, 3348], [3349, 3352], [3353, 3358], [3359, 3362], [3363, 3370], [3371, 3375], [3376, 3380], [3380, 3381], [3382, 3387], [3388, 3399], [3400, 3405], [3406, 3412], [3413, 3423], [3424, 3427], [3428, 3432], [3433, 3441], [3442, 3444], [3445, 3448], [3449, 3468], [3469, 3470], [3470, 3473], [3473, 3474], [3475, 3481], [3481, 3482], [3483, 3490], [3491, 3493], [3494, 3498], [3499, 3503], [3503, 3504], [3504, 3507], [3507, 3508], [3512, 3518], [3519, 3520], [3520, 3521], [3522, 3535], [3536, 3547], [3548, 3556], [3557, 3566], [3567, 3571], [3572, 3579], [3581, 3587], [3588, 3589], [3589, 3590], [3591, 3599], [3600, 3605], [3606, 3612], [3613, 3622], [3623, 3625], [3626, 3627], [3628, 3631], [3632, 3638], [3641, 3644], [3645, 3647], [3648, 3655], [3656, 3659], [3660, 3667], [3668, 3675], [3676, 3682], [3683, 3691], [3692, 3703], [3704, 3706], [3707, 3710], [3711, 3718], [3718, 3719], [3720, 3725], [3726, 3729], [3730, 3740], [3741, 3745], [3746, 3754], [3755, 3757], [3758, 3760], [3761, 3769], [3770, 3775], [3776, 3781], [3782, 3787], [3788, 3791], [3792, 3794], [3795, 3799], [3800, 3802], [3803, 3808], [3809, 3815], [3816, 3819], [3820, 3831], [3832, 3837], [3837, 3838], [3839, 3846], [3847, 3856], [3856, 3857], [3858, 3861], [3862, 3865], [3866, 3876], [3877, 3879], [3880, 3890], [3890, 3891], [3892, 3897], [3898, 3904], [3904, 3905], [3906, 3910], [3911, 3914], [3915, 3919], [3920, 3924], [3925, 3934], [3935, 3937], [3938, 3945], [3946, 3950], [3951, 3958], [3959, 3966], [3967, 3974], [3975, 3979], [3980, 3988], [3989, 3992], [3993, 3997], [3998, 4000], [4001, 4005], [4006, 4009], [4010, 4017], [4017, 4018], [4019, 4024], [4025, 4035], [4036, 4037], [4038, 4041], [4042, 4048], [4049, 4057], [4058, 4060], [4061, 4064], [4065, 4073], [4073, 4074], [4075, 4084], [4085, 4091], [4092, 4095], [4096, 4107], [4108, 4111], [4112, 4121], [4122, 4124], [4125, 4128], [4129, 4135], [4135, 4136], [4137, 4142], [4143, 4146], [4147, 4150], [4151, 4157], [4158, 4165], [4166, 4177], [4178, 4182], [4183, 4187], [4188, 4192], [4193, 4196], [4197, 4203], [4204, 4206], [4207, 4212], [4213, 4216], [4217, 4227], [4228, 4230], [4231, 4240], [4241, 4247], [4247, 4248], [4249, 4255], [4256, 4266], [4267, 4281], [4282, 4283], [4283, 4286], [4286, 4287], [4288, 4291], [4292, 4302], [4303, 4311], [4311, 4312], [4313, 4322], [4323, 4328], [4329, 4332], [4333, 4347], [4348, 4354], [4355, 4363], [4364, 4370], [4370, 4371], [4372, 4376], [4377, 4379], [4380, 4390], [4391, 4402], [4403, 4407], [4408, 4417], [4418, 4421], [4422, 4428], [4429, 4437], [4438, 4446], [4447, 4458], [4459, 4461], [4462, 4465], [4466, 4468], [4469, 4473], [4474, 4480], [4481, 4486], [4487, 4494], [4495, 4502], [4503, 4513], [4514, 4522], [4523, 4525], [4526, 4529], [4530, 4538], [4538, 4539], [4540, 4542], [4543, 4547], [4548, 4552], [4553, 4562], [4563, 4570], [4570, 4571], [4572, 4579], [4579, 4580], [4581, 4589], [4589, 4590], [4591, 4594], [4595, 4610], [4611, 4613], [4614, 4624], [4625, 4629], [4630, 4633], [4634, 4640], [4640, 4641], [4642, 4650], [4651, 4654], [4655, 4663], [4664, 4672], [4673, 4677], [4678, 4684], [4684, 4685], [4686, 4695], [4696, 4699], [4700, 4707], [4708, 4715], [4716, 4724], [4725, 4732], [4732, 4733], [4733, 4734], [4743, 4750], [4756, 4763], [4764, 4768], [4769, 4772], [4773, 4779], [4780, 4790], [4795, 4803], [4804, 4810], [4811, 4814], [4815, 4821], [4822, 4832]]}, {"type": "SEGMENT", "hasID": false, "hasSpan": true, "attrs": [{"name": "annotator", "type": "string", "aggregation": null}, {"name": "set", "type": "string", "aggregation": null}, {"name": "status", "type": "string", "aggregation": null}], "annots": [[0, 4833, "lparker", "content", "human gold"]]}, {"type": "Embedded Payloads (T1027.009)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1947, 2029]]}, {"type": "Obfuscated Files or Information (T1027)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[2251, 2273]]}, {"type": "Brute Force (T1110)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[2970, 2989], [3145, 3183]]}, {"type": "Valid Accounts (T1078)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[3382, 3399]]}, {"type": "Exfiltration Over C2 Channel (T1041)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[3433, 3482]]}, {"type": "Non-Application Layer Protocol (T1095)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[3483, 3507]]}], "version": 2}