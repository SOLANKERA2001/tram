{"signal": "title: Threat Advisory: 3CX Softphone Supply Chain Compromise\nurl: https://blog.talosintelligence.com/3cx-softphone-supply-chain-compromise/\n\nCisco Talos is tracking and actively responding to a supply chain attack involving the 3CX Desktop Softphone application.This is a multi-stage attack that involves sideloading DLLs, seven-day sleep routines, and additional payloads dependent on a now-removed GitHub repository for Windows-based systems.MacOS systems used a different infection chain leveraging a hardcoded C2 domain, as opposed to the GitHub repo.This is just the latest supply chain attack threatening users, after the SolarWinds incident in 2020 and the REvil ransomware group exploiting Kaseya VSA in 2021.SummaryCisco Talos recently became aware of a supply chain attack affecting Windows and MacOS users of the 3CX software-based phone application. This attack leveraged the legitimate update functionality of the 3CX application to deliver a set of malicious payloads to 3CX users. The infection chain consists of several stages and involves sideloading DLLs along with a seven-day sleep cycle before the malware attempts to retrieve additional malicious artifacts from a now-removed GitHub repository for the Windows based infection. The GitHub repository hosted a series of icon files with encrypted data appended to the end of the files. These encrypted strings, once decrypted, contained the C2 domains for additional malicious artifacts.The MacOS version used a hard coded C2 domain. These second-stage payloads are information stealers that attempt to obtain system information and the latest browsing history records, indicating this information may be used as a filtering mechanism to identify and discard some victims while maintaining unauthorized access to others. During our investigation we were able to see file activity dating back to February 3, 2023. However, the GitHub repository has been active since December 2022. The full scope of the attack is uncertain at this point. The 3CX website claims to have over 600,000 customers and 12 million daily users. It's unclear how many are users of the 3CX Desktop App versus the web app option that was not affected. 3CX is currently asking users to use the web app while they work to release an update.Preparing since February 2022Based on Cisco Talos investigation, it appears the infrastructure that supported this attack was being prepared as early as February 2022 when the domains were first registered. A second cluster of activity happened toward the end of 2022 when the GitHub repository was created, along with a few other domains. The sbmsa[.]wiki domain was also created on Feb. 9, 2023, which was found to be used by the second stage of the MacOS version.The timeline below illustrates these clusters of activity.Timeline of domain registration activity.CoverageCisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the malware detailed in this post. Try Secure Endpoint for free here.Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part of their campaign. You can try Secure Email for free here.Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with this threat.Cisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic automatically and alerts users of potentially unwanted activity on every connected device.Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all Cisco Secure products.Umbrella, Ciscoâ€™s secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here.Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous sites and tests suspicious sites before users access them. Additional protections with context to your specific environment and threat data are available from the Firewall Management Center.Cisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your network. Open-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on Snort.org.Talos created the following coverage for this:Snort SIDs:Snort 3: 300480,300481Snort 2: 61550-61553Orbital QueriesCisco Secure Endpoint users can use Orbital Advanced Search to run complex OSqueries to see if their endpoints are infected with this specific threat. For specific OSqueries on this threat, Cisco Secure Endpoint customers need to make sure that \"%3CX%\" is entered into the program field under the \"Installed Program Search\" for Windows and \".*3CX.*\" under \"Installed Applications Monitoring\" for MacOS in Orbital.Additionally, the users can access the OSQueries directly on GitHub for both Windows and MacOS.Indicators of Compromise (IOCs)Indicators of compromise (IOCs) associated with ongoing activity can be found here.\n", "metadata": {"phasesDone": ["zone", "token", "content"]}, "asets": [{"type": "zone", "hasID": false, "hasSpan": true, "attrs": [{"name": "region_type", "type": "string", "aggregation": null}], "annots": [[0, 5214, "body"]]}, {"type": "lex", "hasID": false, "hasSpan": true, "attrs": [], "annots": [[0, 5], [5, 6], [7, 13], [14, 22], [22, 23], [24, 27], [28, 37], [38, 44], [45, 50], [51, 61], [62, 65], [65, 66], [67, 72], [72, 75], [75, 79], [79, 80], [80, 97], [97, 98], [98, 101], [101, 102], [102, 105], [105, 139], [139, 140], [142, 147], [148, 153], [154, 156], [157, 165], [166, 169], [170, 178], [179, 189], [190, 192], [193, 194], [195, 201], [202, 207], [208, 214], [215, 224], [225, 228], [229, 232], [233, 240], [241, 250], [251, 262], [262, 263], [263, 267], [268, 270], [271, 272], [273, 284], [285, 291], [292, 296], [297, 305], [306, 317], [318, 322], [322, 323], [324, 333], [334, 339], [340, 348], [348, 349], [350, 353], [354, 364], [365, 373], [374, 383], [384, 386], [387, 388], [389, 400], [401, 407], [408, 418], [419, 422], [423, 436], [437, 444], [444, 445], [445, 450], [451, 458], [459, 463], [464, 465], [466, 475], [476, 485], [486, 491], [492, 502], [503, 504], [505, 514], [515, 517], [518, 524], [524, 525], [526, 528], [529, 536], [537, 539], [540, 543], [544, 550], [551, 555], [555, 556], [556, 560], [561, 563], [564, 568], [569, 572], [573, 579], [580, 586], [587, 592], [593, 599], [600, 611], [612, 617], [617, 618], [619, 624], [625, 628], [629, 639], [640, 648], [649, 651], [652, 656], [657, 660], [661, 664], [665, 670], [671, 681], [682, 687], [688, 698], [699, 705], [706, 709], [710, 712], [713, 717], [717, 718], [718, 730], [731, 736], [737, 745], [746, 752], [753, 758], [759, 761], [762, 763], [764, 770], [771, 776], [777, 783], [784, 793], [794, 801], [802, 805], [806, 811], [812, 817], [818, 820], [821, 824], [825, 828], [829, 843], [844, 849], [850, 861], [861, 862], [863, 867], [868, 874], [875, 884], [885, 888], [889, 899], [900, 906], [907, 920], [921, 923], [924, 927], [928, 931], [932, 943], [944, 946], [947, 954], [955, 956], [957, 960], [961, 963], [964, 973], [974, 982], [983, 985], [986, 989], [990, 995], [995, 996], [997, 1000], [1001, 1010], [1011, 1016], [1017, 1025], [1026, 1028], [1029, 1036], [1037, 1043], [1044, 1047], [1048, 1056], [1057, 1068], [1069, 1073], [1074, 1079], [1080, 1084], [1085, 1086], [1087, 1096], [1097, 1102], [1103, 1108], [1109, 1115], [1116, 1119], [1120, 1127], [1128, 1136], [1137, 1139], [1140, 1148], [1149, 1159], [1160, 1169], [1170, 1179], [1180, 1184], [1185, 1186], [1187, 1198], [1199, 1205], [1206, 1216], [1217, 1220], [1221, 1224], [1225, 1232], [1233, 1238], [1239, 1248], [1248, 1249], [1250, 1253], [1254, 1260], [1261, 1271], [1272, 1278], [1279, 1280], [1281, 1287], [1288, 1290], [1291, 1295], [1296, 1301], [1302, 1306], [1307, 1316], [1317, 1321], [1322, 1330], [1331, 1333], [1334, 1337], [1338, 1341], [1342, 1344], [1345, 1348], [1349, 1354], [1354, 1355], [1356, 1361], [1362, 1371], [1372, 1379], [1379, 1380], [1381, 1385], [1386, 1395], [1395, 1396], [1397, 1406], [1407, 1410], [1411, 1413], [1414, 1421], [1422, 1425], [1426, 1436], [1437, 1446], [1447, 1456], [1456, 1457], [1457, 1460], [1461, 1466], [1467, 1474], [1475, 1479], [1480, 1481], [1482, 1486], [1487, 1492], [1493, 1495], [1496, 1502], [1502, 1503], [1504, 1509], [1510, 1522], [1523, 1531], [1532, 1535], [1536, 1547], [1548, 1556], [1557, 1561], [1562, 1569], [1570, 1572], [1573, 1579], [1580, 1586], [1587, 1598], [1599, 1602], [1603, 1606], [1607, 1613], [1614, 1622], [1623, 1630], [1631, 1638], [1638, 1639], [1640, 1650], [1651, 1655], [1656, 1667], [1668, 1671], [1672, 1674], [1675, 1679], [1680, 1682], [1683, 1684], [1685, 1694], [1695, 1704], [1705, 1707], [1708, 1716], [1717, 1720], [1721, 1728], [1729, 1733], [1734, 1741], [1742, 1747], [1748, 1759], [1760, 1772], [1773, 1779], [1780, 1782], [1783, 1789], [1789, 1790], [1791, 1797], [1798, 1801], [1802, 1815], [1816, 1818], [1819, 1823], [1824, 1828], [1829, 1831], [1832, 1835], [1836, 1840], [1841, 1849], [1850, 1856], [1857, 1861], [1862, 1864], [1865, 1873], [1874, 1875], [1875, 1876], [1877, 1881], [1881, 1882], [1883, 1890], [1890, 1891], [1892, 1895], [1896, 1902], [1903, 1913], [1914, 1917], [1918, 1922], [1923, 1929], [1930, 1935], [1936, 1944], [1945, 1949], [1949, 1950], [1951, 1954], [1955, 1959], [1960, 1965], [1966, 1968], [1969, 1972], [1973, 1979], [1980, 1982], [1983, 1992], [1993, 1995], [1996, 2000], [2001, 2006], [2006, 2007], [2008, 2011], [2012, 2015], [2016, 2023], [2024, 2030], [2031, 2033], [2034, 2038], [2039, 2043], [2044, 2051], [2052, 2061], [2062, 2065], [2066, 2068], [2069, 2076], [2077, 2082], [2083, 2088], [2088, 2089], [2090, 2092], [2092, 2094], [2095, 2102], [2103, 2106], [2107, 2111], [2112, 2115], [2116, 2121], [2122, 2124], [2125, 2128], [2129, 2132], [2133, 2140], [2141, 2144], [2145, 2151], [2152, 2155], [2156, 2159], [2160, 2163], [2164, 2170], [2171, 2175], [2176, 2179], [2180, 2183], [2184, 2192], [2192, 2193], [2194, 2197], [2198, 2200], [2201, 2210], [2211, 2217], [2218, 2223], [2224, 2226], [2227, 2230], [2231, 2234], [2235, 2238], [2239, 2242], [2243, 2248], [2249, 2253], [2254, 2258], [2259, 2261], [2262, 2269], [2270, 2272], [2273, 2279], [2279, 2280], [2280, 2289], [2290, 2295], [2296, 2304], [2305, 2314], [2315, 2317], [2318, 2323], [2324, 2329], [2330, 2343], [2343, 2344], [2345, 2347], [2348, 2355], [2356, 2359], [2360, 2374], [2375, 2379], [2380, 2389], [2390, 2394], [2395, 2401], [2402, 2405], [2406, 2411], [2412, 2420], [2421, 2423], [2424, 2429], [2430, 2432], [2433, 2441], [2442, 2446], [2447, 2451], [2452, 2455], [2456, 2463], [2464, 2468], [2469, 2474], [2475, 2485], [2485, 2486], [2487, 2488], [2489, 2495], [2496, 2503], [2504, 2506], [2507, 2515], [2516, 2524], [2525, 2531], [2532, 2535], [2536, 2539], [2540, 2542], [2543, 2547], [2548, 2552], [2553, 2556], [2557, 2563], [2564, 2574], [2575, 2578], [2579, 2586], [2586, 2587], [2588, 2593], [2594, 2598], [2599, 2600], [2601, 2604], [2605, 2610], [2611, 2618], [2618, 2619], [2620, 2623], [2624, 2630], [2630, 2632], [2632, 2636], [2637, 2643], [2644, 2647], [2648, 2652], [2653, 2660], [2661, 2663], [2664, 2668], [2669, 2670], [2670, 2671], [2672, 2676], [2676, 2677], [2678, 2683], [2684, 2687], [2688, 2693], [2694, 2696], [2697, 2699], [2700, 2704], [2705, 2707], [2708, 2711], [2712, 2718], [2719, 2724], [2725, 2727], [2728, 2731], [2732, 2737], [2738, 2745], [2745, 2746], [2746, 2749], [2750, 2758], [2759, 2764], [2765, 2776], [2777, 2782], [2783, 2791], [2792, 2794], [2795, 2803], [2803, 2804], [2804, 2812], [2813, 2815], [2816, 2822], [2823, 2835], [2836, 2844], [2844, 2845], [2845, 2858], [2859, 2865], [2866, 2874], [2875, 2876], [2876, 2884], [2885, 2888], [2889, 2892], [2893, 2902], [2902, 2903], [2904, 2906], [2907, 2914], [2915, 2921], [2922, 2924], [2925, 2932], [2933, 2936], [2937, 2946], [2947, 2949], [2950, 2953], [2954, 2961], [2962, 2970], [2971, 2973], [2974, 2978], [2979, 2983], [2983, 2984], [2985, 2988], [2989, 2995], [2996, 3004], [3005, 3008], [3009, 3013], [3014, 3018], [3018, 3019], [3019, 3024], [3025, 3031], [3032, 3037], [3038, 3039], [3039, 3047], [3048, 3053], [3054, 3059], [3060, 3068], [3068, 3069], [3070, 3073], [3074, 3079], [3080, 3089], [3090, 3096], [3097, 3101], [3102, 3104], [3105, 3111], [3112, 3118], [3119, 3121], [3122, 3126], [3127, 3129], [3130, 3135], [3136, 3144], [3144, 3145], [3146, 3149], [3150, 3153], [3154, 3157], [3158, 3164], [3165, 3170], [3171, 3174], [3175, 3179], [3180, 3184], [3184, 3185], [3185, 3190], [3191, 3197], [3198, 3206], [3207, 3208], [3208, 3216], [3217, 3232], [3233, 3241], [3242, 3245], [3246, 3255], [3256, 3260], [3260, 3261], [3262, 3272], [3273, 3277], [3278, 3280], [3281, 3287], [3288, 3295], [3296, 3303], [3303, 3304], [3305, 3313], [3314, 3322], [3323, 3332], [3333, 3336], [3337, 3343], [3344, 3346], [3347, 3350], [3351, 3357], [3358, 3367], [3368, 3376], [3377, 3387], [3388, 3392], [3393, 3397], [3398, 3404], [3404, 3405], [3405, 3410], [3411, 3417], [3418, 3425], [3425, 3426], [3426, 3431], [3432, 3441], [3442, 3443], [3443, 3455], [3455, 3456], [3456, 3468], [3469, 3474], [3474, 3475], [3476, 3484], [3485, 3492], [3493, 3500], [3501, 3514], [3515, 3518], [3519, 3525], [3526, 3531], [3532, 3534], [3535, 3546], [3547, 3555], [3556, 3564], [3565, 3567], [3568, 3573], [3574, 3583], [3584, 3590], [3590, 3591], [3591, 3596], [3597, 3603], [3604, 3611], [3612, 3621], [3622, 3623], [3623, 3629], [3630, 3634], [3634, 3635], [3636, 3646], [3647, 3656], [3657, 3665], [3666, 3669], [3670, 3676], [3677, 3687], [3688, 3692], [3693, 3696], [3697, 3702], [3703, 3709], [3710, 3718], [3718, 3719], [3719, 3727], [3727, 3728], [3729, 3736], [3737, 3743], [3744, 3752], [3753, 3760], [3761, 3762], [3762, 3765], [3765, 3767], [3768, 3774], [3775, 3780], [3781, 3785], [3786, 3796], [3797, 3799], [3800, 3809], [3810, 3817], [3817, 3818], [3819, 3822], [3823, 3826], [3827, 3831], [3831, 3832], [3833, 3840], [3841, 3846], [3847, 3850], [3851, 3853], [3854, 3856], [3857, 3860], [3861, 3864], [3865, 3874], [3875, 3882], [3882, 3883], [3884, 3888], [3889, 3891], [3892, 3895], [3896, 3897], [3898, 3902], [3903, 3908], [3909, 3911], [3912, 3920], [3921, 3925], [3925, 3926], [3926, 3931], [3932, 3938], [3939, 3942], [3943, 3952], [3953, 3954], [3954, 3962], [3963, 3966], [3967, 3975], [3976, 3985], [3985, 3986], [3987, 4000], [4001, 4007], [4008, 4019], [4020, 4029], [4030, 4035], [4036, 4039], [4040, 4045], [4046, 4056], [4057, 4062], [4063, 4069], [4070, 4075], [4076, 4082], [4083, 4087], [4087, 4088], [4089, 4099], [4100, 4111], [4112, 4116], [4117, 4124], [4125, 4127], [4128, 4132], [4133, 4141], [4142, 4153], [4154, 4157], [4158, 4164], [4165, 4169], [4170, 4173], [4174, 4183], [4184, 4188], [4189, 4192], [4193, 4201], [4202, 4212], [4213, 4219], [4219, 4220], [4220, 4225], [4226, 4229], [4230, 4238], [4239, 4251], [4252, 4266], [4267, 4270], [4271, 4276], [4277, 4279], [4280, 4286], [4287, 4291], [4292, 4297], [4298, 4308], [4309, 4312], [4313, 4322], [4323, 4327], [4328, 4335], [4335, 4336], [4337, 4348], [4349, 4354], [4355, 4365], [4366, 4370], [4371, 4374], [4375, 4384], [4385, 4388], [4389, 4393], [4394, 4396], [4397, 4399], [4400, 4404], [4405, 4407], [4408, 4419], [4420, 4423], [4424, 4430], [4431, 4435], [4436, 4440], [4441, 4450], [4451, 4454], [4455, 4463], [4464, 4466], [4467, 4472], [4472, 4473], [4473, 4476], [4476, 4477], [4477, 4482], [4483, 4490], [4491, 4494], [4495, 4504], [4505, 4513], [4514, 4517], [4518, 4522], [4522, 4523], [4523, 4528], [4529, 4533], [4533, 4534], [4534, 4539], [4540, 4541], [4541, 4542], [4543, 4556], [4556, 4561], [4562, 4563], [4563, 4564], [4565, 4576], [4576, 4583], [4584, 4596], [4597, 4603], [4604, 4612], [4613, 4618], [4619, 4622], [4623, 4626], [4627, 4634], [4635, 4643], [4644, 4650], [4651, 4653], [4654, 4657], [4658, 4665], [4666, 4675], [4676, 4678], [4679, 4682], [4683, 4685], [4686, 4691], [4692, 4701], [4702, 4705], [4706, 4714], [4715, 4719], [4720, 4724], [4725, 4733], [4734, 4740], [4740, 4741], [4742, 4745], [4746, 4754], [4755, 4764], [4765, 4767], [4768, 4772], [4773, 4779], [4779, 4780], [4781, 4786], [4787, 4793], [4794, 4802], [4803, 4812], [4813, 4817], [4818, 4820], [4821, 4825], [4826, 4830], [4831, 4835], [4836, 4837], [4837, 4842], [4842, 4843], [4844, 4846], [4847, 4854], [4855, 4859], [4860, 4863], [4864, 4871], [4872, 4877], [4878, 4883], [4884, 4887], [4888, 4889], [4889, 4898], [4899, 4906], [4907, 4913], [4913, 4914], [4915, 4918], [4919, 4926], [4927, 4930], [4931, 4934], [4934, 4937], [4937, 4940], [4941, 4946], [4947, 4948], [4948, 4957], [4958, 4970], [4971, 4981], [4981, 4982], [4983, 4986], [4987, 4992], [4993, 4995], [4996, 5003], [5003, 5004], [5004, 5016], [5016, 5017], [5018, 5021], [5022, 5027], [5028, 5031], [5032, 5038], [5039, 5042], [5043, 5052], [5053, 5061], [5062, 5064], [5065, 5071], [5072, 5075], [5076, 5080], [5081, 5088], [5089, 5092], [5093, 5098], [5098, 5099], [5099, 5109], [5110, 5112], [5113, 5123], [5124, 5125], [5125, 5129], [5129, 5130], [5130, 5140], [5141, 5143], [5144, 5154], [5155, 5156], [5156, 5160], [5160, 5161], [5162, 5172], [5173, 5177], [5178, 5185], [5186, 5194], [5195, 5198], [5199, 5201], [5202, 5207], [5208, 5212], [5212, 5213]]}, {"type": "SEGMENT", "hasID": false, "hasSpan": true, "attrs": [{"name": "annotator", "type": "string", "aggregation": null}, {"name": "set", "type": "string", "aggregation": null}, {"name": "status", "type": "string", "aggregation": null}], "annots": [[0, 5214, "jlasky", "content", "human gold"]]}, {"type": "DLL Side-Loading (T1574.002)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[263, 323], [1048, 1079]]}, {"type": "Binary Padding (T1027.001)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1291, 1355]]}, {"type": "Process Injection (T1055)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": []}, {"type": "Obfuscated Files or Information (T1027)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1356, 1380]]}, {"type": "Deobfuscate/Decode Files or Information (T1140)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1381, 1457]]}, {"type": "System Information Discovery (T1082)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1562, 1598]]}, {"type": "[OTHER]", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1562, 1639, "T1217"], [2553, 2619, "T1102"], [764, 862, "T1195.002"]]}, {"type": "Ingress Tool Transfer (T1105)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1116, 1179]]}], "version": 2}