{"signal": "title: Tracking Traces of Malware Disguised as Hancom Office Document File and Being Distributed (RedEyes)\nurl: https://asec.ahnlab.com/en/53377/\n\nAhnLab Security Emergency response Center (ASEC) has confirmed the distribution of malware disguised as Hancom Office document files. The malware that is being distributed is named “Who and What Threatens the World (Column).exe” and is designed to deceive users by using an icon that is similar to that of Hancom Office. Decompressing the compressed file reveals a relatively large file with a size of 36,466,238 bytes. AhnLab Endpoint Detection and Response (EDR) is capable of detecting such attack techniques through its trace data, and it allows users to check the data required to investigate the related breach case.\n\nFigure 1. Execution flow diagram\nFigure 1 depicts the icon of the malware and its overall execution. It provides a visual representation of which processes are used when the malware is executed.\n\nFigure 2. File trace data of malware creation\n\nFigure 3. Primary trace data of malware\nFigures 2 and 3 show the trace data of key behaviors within the overall flow of the malware. In Figure 2, a trace can be observed of the malware creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file. In Figure 3, a trace can be seen of the malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed. The malware is injected and executed within the normal Windows process called mstsc.exe. The original file is deleted using the cmd command.\n\nFigure 4. Trace data of the normal Windows process, mstsc.exe\nFigure 4 displays the trace data of mstsc.exe being executed after being injected with malware. The malware registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted. Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe. The URL registered in the task scheduler appears to be a normal homepage, but it contains a web shell. The inserted web shell has been confirmed to be similar to the one posted in “Targeted Attack on a Website Developed by a Specific Web Design Company (Red Eyes and APT37)” on the AhnLab Threat Intelligence Platform.\nWhen it comes to targeted attacks, there are factors that general users may struggle to deal with. Even if users find themselves exposed to such threats, AhnLab EDR can provide trace data for appropriate responses.\n[File Detection]– Trojan/Win.Agent.R580958 (2023.05.24.02)\n[IOC]MD5\n– 93fc0fb9b87a00b38f18c1cc4ee02e50\nC2\n– hxxp://ingarchi.com/bbs/data/culture– hxxp://ingarchi.com/bbs/data/culture/getcfg.php\nAhnLab EDR protects the endpoint environment by delivering behavioral detection, advanced analysis, holistic visibility, and proactive threat hunting. For more information about the product, please visit our official website.\n\nThe post Tracking Traces of Malware Disguised as Hancom Office Document File and Being Distributed (RedEyes) appeared first on ASEC BLOG.\n", "metadata": {"phasesDone": ["zone", "token", "content"]}, "asets": [{"type": "zone", "hasID": false, "hasSpan": true, "attrs": [{"name": "region_type", "type": "string", "aggregation": null}], "annots": [[0, 3261, "body"]]}, {"type": "lex", "hasID": false, "hasSpan": true, "attrs": [], "annots": [[0, 5], [5, 6], [7, 15], [16, 22], [23, 25], [26, 33], [34, 43], [44, 46], [47, 53], [54, 60], [61, 69], [70, 74], [75, 78], [79, 84], [85, 96], [97, 98], [98, 105], [105, 106], [107, 110], [110, 111], [112, 117], [117, 120], [120, 124], [124, 125], [125, 131], [131, 132], [132, 135], [135, 136], [136, 138], [138, 139], [139, 144], [144, 145], [147, 153], [154, 162], [163, 172], [173, 181], [182, 188], [189, 190], [190, 194], [194, 195], [196, 199], [200, 209], [210, 213], [214, 226], [227, 229], [230, 237], [238, 247], [248, 250], [251, 257], [258, 264], [265, 273], [274, 279], [279, 280], [281, 284], [285, 292], [293, 297], [298, 300], [301, 306], [307, 318], [319, 321], [322, 327], [328, 332], [333, 336], [337, 341], [342, 351], [352, 355], [356, 361], [362, 363], [363, 369], [369, 371], [371, 375], [376, 379], [380, 382], [383, 391], [392, 394], [395, 402], [403, 408], [409, 411], [412, 417], [418, 420], [421, 425], [426, 430], [431, 433], [434, 441], [442, 444], [445, 449], [450, 452], [453, 459], [460, 466], [466, 467], [468, 481], [482, 485], [486, 496], [497, 501], [502, 509], [510, 511], [512, 522], [523, 528], [529, 533], [534, 538], [539, 540], [541, 545], [546, 548], [549, 559], [560, 565], [565, 566], [566, 573], [574, 582], [583, 592], [593, 596], [597, 605], [606, 607], [607, 610], [610, 611], [612, 614], [615, 622], [623, 625], [626, 635], [636, 640], [641, 647], [648, 658], [659, 666], [667, 670], [671, 676], [677, 681], [681, 682], [683, 686], [687, 689], [690, 696], [697, 702], [703, 705], [706, 711], [712, 715], [716, 720], [721, 729], [730, 732], [733, 744], [745, 748], [749, 756], [757, 763], [764, 768], [768, 769], [771, 777], [778, 779], [779, 780], [781, 790], [791, 795], [796, 803], [804, 810], [811, 812], [813, 820], [821, 824], [825, 829], [830, 832], [833, 836], [837, 844], [845, 848], [849, 852], [853, 860], [861, 870], [870, 871], [872, 874], [875, 883], [884, 885], [886, 892], [893, 907], [908, 910], [911, 916], [917, 926], [927, 930], [931, 935], [936, 940], [941, 944], [945, 952], [953, 955], [956, 964], [964, 965], [967, 973], [974, 975], [975, 976], [977, 981], [982, 987], [988, 992], [993, 995], [996, 1003], [1004, 1012], [1014, 1020], [1021, 1022], [1022, 1023], [1024, 1031], [1032, 1037], [1038, 1042], [1043, 1045], [1046, 1053], [1054, 1061], [1062, 1063], [1064, 1067], [1068, 1069], [1070, 1074], [1075, 1078], [1079, 1084], [1085, 1089], [1090, 1092], [1093, 1096], [1097, 1106], [1107, 1113], [1114, 1117], [1118, 1125], [1126, 1130], [1131, 1133], [1134, 1137], [1138, 1145], [1145, 1146], [1147, 1149], [1150, 1156], [1157, 1158], [1158, 1159], [1160, 1161], [1162, 1167], [1168, 1171], [1172, 1174], [1175, 1183], [1184, 1186], [1187, 1190], [1191, 1198], [1199, 1207], [1208, 1209], [1210, 1216], [1217, 1222], [1223, 1234], [1235, 1237], [1238, 1241], [1242, 1249], [1250, 1259], [1260, 1263], [1264, 1276], [1277, 1283], [1284, 1288], [1289, 1292], [1293, 1301], [1302, 1313], [1313, 1314], [1314, 1317], [1318, 1320], [1321, 1327], [1328, 1330], [1331, 1332], [1333, 1339], [1340, 1344], [1344, 1345], [1346, 1348], [1349, 1355], [1356, 1357], [1357, 1358], [1359, 1360], [1361, 1366], [1367, 1370], [1371, 1373], [1374, 1378], [1379, 1381], [1382, 1385], [1386, 1393], [1394, 1402], [1403, 1406], [1407, 1416], [1417, 1418], [1419, 1425], [1426, 1432], [1433, 1439], [1440, 1444], [1445, 1449], [1450, 1453], [1454, 1458], [1459, 1467], [1468, 1470], [1471, 1474], [1475, 1482], [1483, 1489], [1490, 1493], [1494, 1498], [1499, 1508], [1509, 1514], [1515, 1518], [1519, 1526], [1527, 1530], [1531, 1539], [1539, 1540], [1541, 1544], [1545, 1552], [1553, 1555], [1556, 1564], [1565, 1568], [1569, 1577], [1578, 1584], [1585, 1588], [1589, 1595], [1596, 1603], [1604, 1611], [1612, 1618], [1619, 1624], [1624, 1625], [1625, 1628], [1628, 1629], [1630, 1633], [1634, 1642], [1643, 1647], [1648, 1650], [1651, 1658], [1659, 1664], [1665, 1668], [1669, 1672], [1673, 1680], [1680, 1681], [1683, 1689], [1690, 1691], [1691, 1692], [1693, 1698], [1699, 1703], [1704, 1706], [1707, 1710], [1711, 1717], [1718, 1725], [1726, 1733], [1733, 1734], [1735, 1740], [1740, 1741], [1741, 1744], [1745, 1751], [1752, 1753], [1754, 1762], [1763, 1766], [1767, 1772], [1773, 1777], [1778, 1780], [1781, 1786], [1786, 1787], [1787, 1790], [1791, 1796], [1797, 1805], [1806, 1811], [1812, 1817], [1818, 1826], [1827, 1831], [1832, 1839], [1839, 1840], [1841, 1844], [1845, 1852], [1853, 1862], [1863, 1866], [1867, 1871], [1872, 1876], [1877, 1880], [1881, 1885], [1886, 1897], [1898, 1903], [1904, 1907], [1908, 1911], [1912, 1915], [1916, 1918], [1919, 1924], [1925, 1927], [1928, 1932], [1933, 1935], [1936, 1939], [1940, 1945], [1946, 1949], [1950, 1956], [1957, 1959], [1960, 1968], [1968, 1969], [1970, 1979], [1979, 1980], [1981, 1983], [1984, 1988], [1989, 1992], [1993, 2001], [2001, 2002], [2002, 2005], [2006, 2013], [2014, 2016], [2017, 2025], [2026, 2029], [2030, 2034], [2035, 2037], [2038, 2041], [2042, 2046], [2047, 2056], [2057, 2061], [2062, 2065], [2066, 2070], [2071, 2081], [2082, 2084], [2085, 2092], [2093, 2095], [2096, 2097], [2098, 2105], [2106, 2109], [2110, 2115], [2116, 2118], [2119, 2126], [2127, 2132], [2133, 2136], [2137, 2143], [2144, 2151], [2152, 2156], [2157, 2162], [2162, 2163], [2163, 2166], [2166, 2167], [2168, 2171], [2172, 2175], [2176, 2186], [2187, 2189], [2190, 2193], [2194, 2198], [2199, 2208], [2209, 2216], [2217, 2219], [2220, 2222], [2223, 2224], [2225, 2231], [2232, 2240], [2240, 2241], [2242, 2245], [2246, 2248], [2249, 2257], [2258, 2259], [2260, 2263], [2264, 2269], [2269, 2270], [2271, 2274], [2275, 2283], [2284, 2287], [2288, 2293], [2294, 2297], [2298, 2302], [2303, 2312], [2313, 2315], [2316, 2318], [2319, 2326], [2327, 2329], [2330, 2333], [2334, 2337], [2338, 2344], [2345, 2347], [2348, 2357], [2358, 2364], [2365, 2367], [2368, 2369], [2370, 2377], [2378, 2387], [2388, 2390], [2391, 2392], [2393, 2401], [2402, 2405], [2406, 2412], [2413, 2420], [2421, 2422], [2422, 2425], [2426, 2430], [2431, 2434], [2435, 2440], [2440, 2441], [2441, 2442], [2443, 2445], [2446, 2449], [2450, 2456], [2457, 2463], [2464, 2476], [2477, 2485], [2485, 2486], [2487, 2491], [2492, 2494], [2495, 2500], [2501, 2503], [2504, 2512], [2513, 2520], [2520, 2521], [2522, 2527], [2528, 2531], [2532, 2539], [2540, 2544], [2545, 2552], [2553, 2558], [2559, 2562], [2563, 2571], [2572, 2574], [2575, 2579], [2580, 2584], [2584, 2585], [2586, 2590], [2591, 2593], [2594, 2599], [2600, 2604], [2605, 2615], [2616, 2623], [2624, 2626], [2627, 2631], [2632, 2639], [2639, 2640], [2641, 2647], [2648, 2651], [2652, 2655], [2656, 2663], [2664, 2669], [2670, 2674], [2675, 2678], [2679, 2690], [2691, 2700], [2700, 2701], [2702, 2707], [2708, 2718], [2718, 2719], [2720, 2726], [2726, 2727], [2727, 2730], [2730, 2731], [2731, 2736], [2736, 2737], [2737, 2744], [2745, 2746], [2746, 2759], [2759, 2760], [2761, 2768], [2768, 2769], [2770, 2804], [2805, 2807], [2808, 2809], [2810, 2814], [2814, 2817], [2817, 2825], [2825, 2826], [2826, 2829], [2829, 2830], [2830, 2833], [2833, 2834], [2834, 2838], [2838, 2839], [2839, 2847], [2848, 2852], [2852, 2855], [2855, 2863], [2863, 2864], [2864, 2867], [2867, 2868], [2868, 2871], [2871, 2872], [2872, 2876], [2876, 2877], [2877, 2884], [2884, 2885], [2885, 2891], [2891, 2892], [2892, 2895], [2896, 2902], [2903, 2906], [2907, 2915], [2916, 2919], [2920, 2928], [2929, 2940], [2941, 2943], [2944, 2954], [2955, 2965], [2966, 2975], [2975, 2976], [2977, 2985], [2986, 2994], [2994, 2995], [2996, 3004], [3005, 3015], [3015, 3016], [3017, 3020], [3021, 3030], [3031, 3037], [3038, 3045], [3045, 3046], [3047, 3050], [3051, 3055], [3056, 3067], [3068, 3073], [3074, 3077], [3078, 3085], [3085, 3086], [3087, 3093], [3094, 3099], [3100, 3103], [3104, 3112], [3113, 3120], [3120, 3121], [3123, 3126], [3127, 3131], [3132, 3140], [3141, 3147], [3148, 3150], [3151, 3158], [3159, 3168], [3169, 3171], [3172, 3178], [3179, 3185], [3186, 3194], [3195, 3199], [3200, 3203], [3204, 3209], [3210, 3221], [3222, 3223], [3223, 3230], [3230, 3231], [3232, 3240], [3241, 3246], [3247, 3249], [3250, 3254], [3255, 3259], [3259, 3260]]}, {"type": "SEGMENT", "hasID": false, "hasSpan": true, "attrs": [{"name": "annotator", "type": "string", "aggregation": null}, {"name": "set", "type": "string", "aggregation": null}, {"name": "status", "type": "string", "aggregation": null}], "annots": [[0, 3261, "lparker", "content", "human gold"]]}, {"type": "Match Legitimate Name or Location (T1036.005)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[230, 280], [328, 467], [1199, 1345], [1386, 1540], [2085, 2167], [2172, 2240]]}, {"type": "Software Packing (T1027.002)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[468, 501]]}, {"type": "Deobfuscate/Decode Files or Information (T1140)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[468, 481]]}, {"type": "Process Injection (T1055)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1556, 1629], [1778, 1839]]}, {"type": "File Deletion (T1070.004)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1651, 1681]]}, {"type": "Modify Registry (T1112)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1853, 1915]]}, {"type": "Registry Run Keys / Startup Folder (T1547.001)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1853, 1969]]}, {"type": "Scheduled Task (T1053.005)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[1993, 2061], [2172, 2208]]}, {"type": "Web Protocols (T1071.001)", "hasID": false, "hasSpan": true, "attrs": [{"name": "comment", "type": "string", "aggregation": null}], "annots": [[2085, 2167]]}], "version": 2}